<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Performing inference on new data &mdash; simlearner3d 3.8.4 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sphinx_paramlinks.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="How to train new models" href="../guides/train_new_model.html" />
    <link rel="prev" title="Preparing data for training" href="prepare_dataset.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> simlearner3d
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install_on_linux.html">Install Simlearner3D on Linux</a><ul>
<li class="toctree-l2"><a class="reference internal" href="install_on_linux.html#setting-up-a-virtual-environment">Setting up a virtual environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="install_on_linux.html#install-source-as-a-package">Install source as a package</a></li>
<li class="toctree-l2"><a class="reference internal" href="install_on_linux.html#troubleshooting">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="install_on_wsl2.html">Install Simlearner3d on WSL2 with CUDA support</a><ul>
<li class="toctree-l2"><a class="reference internal" href="install_on_wsl2.html#setting-up-wsl2">Setting up WSL2</a></li>
<li class="toctree-l2"><a class="reference internal" href="install_on_wsl2.html#installing-anaconda">Installing Anaconda</a></li>
<li class="toctree-l2"><a class="reference internal" href="install_on_wsl2.html#installing-simlearner3d">Installing Simlearner3D</a></li>
<li class="toctree-l2"><a class="reference internal" href="install_on_wsl2.html#troubleshooting">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="prepare_dataset.html">Preparing data for training</a><ul>
<li class="toctree-l2"><a class="reference internal" href="prepare_dataset.html#peprocessing-functions">Peprocessing functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="prepare_dataset.html#creating-train-val-test-split-dataset-and-split-csv">Creating Train/Val/Test split dataset and split.csv</a></li>
<li class="toctree-l2"><a class="reference internal" href="prepare_dataset.html#create-a-hdf5-dataset">Create a HDF5 Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="prepare_dataset.html#getting-started-quickly-with-a-toy-dataset">Getting started quickly with a toy dataset</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Performing inference on new data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#transforming-ckpt-model-to-scripted-pt-models">Transforming .ckpt model to scripted .pt models</a></li>
<li class="toctree-l2"><a class="reference internal" href="#run-inference-on-a-pair-of-epipolar-images">Run inference on a pair of epipolar images</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../guides/train_new_model.html">How to train new models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../guides/train_new_model.html#setup">Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/train_new_model.html#quick-run">Quick run</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/train_new_model.html#training">Training</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/train_new_model.html#testing-the-model">Testing the model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/train_new_model.html#inference">Inference</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../guides/development.html">Developer’s guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../guides/development.html#code-versionning">Code versionning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/development.html#tests">Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/development.html#continuous-integration-ci">Continuous Integration (CI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/development.html#continuous-delivery-cd">Continuous Delivery (CD)</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Background</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../background/interpolation.html">KNN-Interpolation to merge multiple predictions [TODO]</a></li>
<li class="toctree-l1"><a class="reference internal" href="../background/general_design.html">General design of the package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../background/general_design.html#model-should-be-fast-performant-and-practical">Model should be fast, performant, and practical</a></li>
<li class="toctree-l2"><a class="reference internal" href="../background/general_design.html#subsampling-is-important-to-improve-point-cloud-structure">Subsampling is important to improve point cloud structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../background/general_design.html#speed-is-of-the-essence">Speed is of the essence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../background/general_design.html#evaluation-is-key-to-select-the-right-approach">Evaluation is key to select the right approach</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Package Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../apidoc/scripts.html">Scripts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../apidoc/scripts.html#module-run">run</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apidoc/scripts.html#module-simlearner3d.train">simlearner3d.train</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../apidoc/configs.html">Default configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apidoc/simlearner3d.processing.html">simlearner3d.processing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../apidoc/simlearner3d.processing.html#module-simlearner3d.processing.datamodule.hdf5">simlearner3d.processing.datamodule.hdf5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apidoc/simlearner3d.processing.html#module-simlearner3d.processing.dataset.hdf5">simlearner3d.processing.dataset.hdf5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apidoc/simlearner3d.processing.html#module-simlearner3d.processing.dataset.toy_dataset">simlearner3d.processing.dataset.toy_dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apidoc/simlearner3d.processing.html#module-simlearner3d.processing.dataset.utils">simlearner3d.processing.dataset.utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apidoc/simlearner3d.processing.html#module-simlearner3d.processing.transforms.compose">simlearner3d.processing.transforms.compose</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apidoc/simlearner3d.processing.html#module-simlearner3d.processing.transforms.transforms">simlearner3d.processing.transforms.transforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apidoc/simlearner3d.processing.html#simlearner3d-processing-transforms-augmentations">simlearner3d.processing.transforms.augmentations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../apidoc/simlearner3d.model.html">simlearner3d.models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../apidoc/simlearner3d.model.html#module-simlearner3d.models.generic_model">Model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../apidoc/simlearner3d.models.modules.html">simlearner3d.models.modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../apidoc/simlearner3d.models.modules.html#msaff-unet32-unet-attention">MSAFF - Unet32 - Unet Attention</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../apidoc/simlearner3d.callbacks.html">simlearner3d.callbacks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../apidoc/simlearner3d.callbacks.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apidoc/simlearner3d.callbacks.html#module-simlearner3d.callbacks.comet_callbacks">simlearner3d.callbacks.comet_callbacks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apidoc/simlearner3d.callbacks.html#module-simlearner3d.callbacks.finetuning_callbacks">simlearner3d.callbacks.finetuning_callbacks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apidoc/simlearner3d.callbacks.html#simlearner3d-callbacks-logging-callbacks">simlearner3d.callbacks.logging_callbacks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apidoc/simlearner3d.callbacks.html#module-simlearner3d.callbacks">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../apidoc/simlearner3d.utils.html">simlearner3d.utils</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../apidoc/simlearner3d.utils.html#module-simlearner3d.utils.utils">simlearner3d.utils.utils</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">simlearner3d</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Performing inference on new data</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorials/make_predictions.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="performing-inference-on-new-data">
<h1>Performing inference on new data<a class="headerlink" href="#performing-inference-on-new-data" title="Permalink to this headline"></a></h1>
<p>Refer to the tutorials (<a class="reference internal" href="install_on_linux.html"><span class="doc std std-doc">Linux</span></a>, <a class="reference internal" href="install_on_wsl2.html"><span class="doc std std-doc">Windows</span></a>) for installation instructions.</p>
<p>To run inference, you will need:</p>
<ul class="simple">
<li><p>A checkpoint of a trained lightning module implementing model logic (class <code class="docutils literal notranslate"><span class="pre">simlearner3d.models.generic_model.Model</span></code>)</p></li>
<li><p>A pair of epipolar images</p></li>
<li><p>An installed and working version of <a class="reference external" href="https://github.com/DaliCHEBBI/micmac_SimLearning">our micmac repository</a>.</p></li>
</ul>
<section id="transforming-ckpt-model-to-scripted-pt-models">
<h2>Transforming .ckpt model to scripted .pt models<a class="headerlink" href="#transforming-ckpt-model-to-scripted-pt-models" title="Permalink to this headline"></a></h2>
<p>Our <a class="reference external" href="https://github.com/DaliCHEBBI/micmac_SimLearning">our micmac version</a> leverages learned models together with <a class="reference external" href="https://pytorch.org/get-started/locally/">PyTorch c++ api</a> to perform large scale stereo image matching.
In order to use trained models, you need to script the model checkpoint from pytorchlightning to a .pt model. This is performed using the following command line:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>run.py<span class="w"> </span><span class="se">\</span>
task.task_name<span class="o">=</span>extract_pt<span class="w"> </span><span class="se">\</span>
model.ckpt_path<span class="o">={</span>/path/to/checkpoint.ckpt<span class="o">}</span>
</pre></div>
</div>
</section>
<section id="run-inference-on-a-pair-of-epipolar-images">
<h2>Run inference on a pair of epipolar images<a class="headerlink" href="#run-inference-on-a-pair-of-epipolar-images" title="Permalink to this headline"></a></h2>
<p>Inference routines are implemented in C++ into the open photogrammetry software <a class="reference external" href="https://github.com/micmacIGN/micmac">MicMac</a>.</p>
<p>It tackles large scale stereo matching for large frame aerial imagery and EHR Satellite stereo reconstruction. Our models are embedded into a hierachical multi-resolution pipeline where lower resolution surface reconstructions serve as a prior for the next level reconstruction. This strategy is robust and allows integrating hand-crafted similarity metrics like (ncc, census,…) for lower resolution low context matching.</p>
<p>To perform hierarchical matching using our similarity learning models, you need to:</p>
<ul class="simple">
<li><p>git clone our repository and install <code class="docutils literal notranslate"><span class="pre">micmac</span></code> and <code class="docutils literal notranslate"><span class="pre">MicMac</span> <span class="pre">V2</span></code> after downloading plateform specific <span class="xref myst">torch cpp libraries</span>. You may need to modifiy <code class="docutils literal notranslate"><span class="pre">TORCH_INSTALL_PREFIX</span></code> in CMakeLists.txt to point to  <code class="docutils literal notranslate"><span class="pre">libtorch</span></code> folder. For our installation, we set it to <code class="docutils literal notranslate"><span class="pre">${MMVII_SOURCE_DIR}/libtorch</span></code></p></li>
<li><p>compile MMVII and micmac with libtorch</p></li>
<li><p>MicMac uses <code class="docutils literal notranslate"><span class="pre">xml</span> <span class="pre">specifications</span></code> files for hierachical dense image matching, we provide an example xml configuration file:
`
<ParamMICMAC></p></li>
</ul>
<DicoLoc>
       <Symb> ZReg=0.005  </Symb>
       <Symb> DefCor=0.4  </Symb>
       <Symb> CostTrans=1.0 </Symb>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>   &lt;Symb&gt; SzW=3 &lt;/Symb&gt;
   &lt;Symb&gt; PenteMax=3.0 &lt;/Symb&gt;
   &lt;Symb&gt; Interpol=eInterpolBiLin  &lt;/Symb&gt;
   &lt;Symb&gt; DoEpi=true &lt;/Symb&gt;
   &lt;Symb&gt; Ori=Epi    &lt;/Symb&gt;

   &lt;Symb&gt; Im=TEST   &lt;/Symb&gt;

   &lt;Symb&gt; Im1=Im1DUBL.tif &lt;/Symb&gt;
   &lt;Symb&gt; Im2=Im2DUBL.tif &lt;/Symb&gt;

   &lt;Symb&gt; Modele=XXX&lt;/Symb&gt;
   &lt;Symb&gt; WITH_MODELE=true &lt;/Symb&gt;
   &lt;Symb&gt; IncPix=100  &lt;/Symb&gt;
   &lt;Symb&gt; NbDirProg=7   &lt;/Symb&gt;
   &lt;Symb&gt; ExtImIn=tif   &lt;/Symb&gt;
   &lt;Symb&gt; Purge=true   &lt;/Symb&gt;
   &lt;Symb&gt; NbProc=4   &lt;/Symb&gt;
   &lt;Symb&gt; OnCuda=false&lt;/Symb&gt;
   &lt;Symb&gt; UseMLP=false&lt;/Symb&gt;
</pre></div>
</div>
  <!-- Parametres calcule -->
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>    &lt;Symb&gt;  DirMEC=${Modele} &lt;/Symb&gt;
    &lt;Symb&gt;  DirPyram=Pyram/ &lt;/Symb&gt;
</pre></div>
</div>
</DicoLoc>
<p>&lt;Section_Terrain&gt;
<IntervParalaxe>
<Px1IncCalc> ${IncPix} </Px1IncCalc>
</IntervParalaxe></p>
<p>&lt;/Section_Terrain&gt;</p>
<p>&lt;Section_PriseDeVue&gt;</p>
<p><GeomImages> eGeomImage_EpipolairePure </GeomImages></p>
   <Images>
    	<Im1>   ${Im1} </Im1>
    	<Im2>   ${Im2}    </Im2>
   </Images>
   <MasqImageIn>
             <OneMasqueImage>
                <PatternSel>  (.*)\.${ExtImIn}  </PatternSel>
                <NomMasq>  $1_Masq.tif     </NomMasq>
             </OneMasqueImage>
             <AcceptNonExistingFile> true </AcceptNonExistingFile>
   </MasqImageIn>
<p>&lt;/Section_PriseDeVue&gt;</p>
<!--  *************************************************************
       Parametres fixant le comportement
     de l'algo de mise en correspondance
-->
<p>&lt;Section_MEC&gt;
<ChantierFullImage1> true </ChantierFullImage1></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;EtapeMEC&gt;
	    &lt;DeZoom&gt; -1 &lt;/DeZoom&gt;
	    &lt;ModeInterpolation&gt; ${Interpol} &lt;/ModeInterpolation&gt;
	
    &lt;!-- param correl --&gt;
    &lt;SzW&gt; ${SzW} &lt;/SzW&gt;

        &lt;AlgoRegul&gt; eAlgo2PrgDyn &lt;/AlgoRegul&gt;

    &lt;Px1Pas&gt;        1  &lt;/Px1Pas&gt;
        &lt;Px1DilatAlti&gt;  7  &lt;/Px1DilatAlti&gt;
    &lt;Px1DilatPlani&gt; 3  &lt;/Px1DilatPlani&gt;
    &lt;Px1Regul&gt; ${ZReg} &lt;/Px1Regul&gt;

        &lt;GenImagesCorrel&gt; true &lt;/GenImagesCorrel&gt;
    
        &lt;SsResolOptim&gt; 1 &lt;/SsResolOptim&gt;
        &lt;CoxRoyUChar&gt; false &lt;/CoxRoyUChar&gt;


    &lt;ModulationProgDyn&gt;
           &lt;EtapeProgDyn&gt;
        	   &lt;ModeAgreg&gt; ePrgDAgrSomme &lt;/ModeAgreg&gt;
               &lt;NbDir&gt; ${NbDirProg} &lt;/NbDir&gt;
           &lt;/EtapeProgDyn&gt;
           &lt;Px1PenteMax&gt; ${PenteMax} &lt;/Px1PenteMax&gt;
           &lt;ArgMaskAuto&gt;
        	   &lt;ValDefCorrel&gt; ${DefCor} &lt;/ValDefCorrel&gt;
	   &lt;CostTrans&gt; ${CostTrans} &lt;/CostTrans&gt;
               &lt;ReInjectMask&gt; false &lt;/ReInjectMask&gt; 
           &lt;/ArgMaskAuto&gt;
        &lt;/ModulationProgDyn&gt;


&lt;/EtapeMEC&gt;

&lt;!--  &lt;EtapeMEC&gt; &lt;DeZoom&gt; 16 &lt;/DeZoom&gt; &lt;/EtapeMEC&gt;	 --&gt;
&lt;!-- &lt;EtapeMEC&gt; &lt;DeZoom&gt; 64 &lt;/DeZoom&gt; &lt;/EtapeMEC&gt; 
&lt;EtapeMEC&gt; &lt;DeZoom&gt; 32 &lt;/DeZoom&gt; &lt;/EtapeMEC&gt;      --&gt;
&lt;EtapeMEC&gt; &lt;DeZoom&gt; 16 &lt;/DeZoom&gt; &lt;/EtapeMEC&gt;


&lt;EtapeMEC&gt; &lt;DeZoom&gt; 8  &lt;/DeZoom&gt; 
        &lt;CorrelAdHoc&gt;
            &lt;SzBlocAH&gt; 40000000 &lt;/SzBlocAH&gt;
            &lt;TypeCAH&gt;
                &lt;ScoreLearnedMMVII &gt;
                    &lt;FileModeleCost&gt; MVCNNCorrel&lt;/FileModeleCost&gt;
                    &lt;FileModeleParams&gt;../MODEL_MSAFF_AERIAL_DECISION/.*.pt&lt;/FileModeleParams&gt;
                    &lt;FileModeleArch&gt;UnetMLPMatcher&lt;/FileModeleArch&gt;
                    &lt;Cuda&gt; ${OnCuda} &lt;/Cuda&gt;
		&lt;UsePredicNet&gt; ${UseMLP} &lt;/UsePredicNet&gt;
                &lt;/ScoreLearnedMMVII&gt;
            &lt;/TypeCAH&gt;
        &lt;/CorrelAdHoc&gt;
   &lt;/EtapeMEC&gt;

&lt;EtapeMEC&gt; &lt;DeZoom&gt; 4  &lt;/DeZoom&gt; 
        &lt;CorrelAdHoc&gt;
            &lt;SzBlocAH&gt; 40000000 &lt;/SzBlocAH&gt;
            &lt;TypeCAH&gt;
                &lt;ScoreLearnedMMVII &gt;
                    &lt;FileModeleCost&gt; MVCNNCorrel&lt;/FileModeleCost&gt;
                    &lt;FileModeleParams&gt;../MODEL_MSAFF_AERIAL_DECISION/.*.pt&lt;/FileModeleParams&gt;
                    &lt;FileModeleArch&gt;UnetMLPMatcher&lt;/FileModeleArch&gt;
                    &lt;Cuda&gt; ${OnCuda} &lt;/Cuda&gt;
		&lt;UsePredicNet&gt; ${UseMLP} &lt;/UsePredicNet&gt;
                &lt;/ScoreLearnedMMVII&gt;
            &lt;/TypeCAH&gt;
        &lt;/CorrelAdHoc&gt;
   &lt;/EtapeMEC&gt;
&lt;EtapeMEC&gt; 
    &lt;DeZoom&gt; 2  &lt;/DeZoom&gt; 
        &lt;CorrelAdHoc&gt;
            &lt;SzBlocAH&gt; 40000000 &lt;/SzBlocAH&gt;
            &lt;TypeCAH&gt;
                &lt;ScoreLearnedMMVII &gt;
                    &lt;FileModeleCost&gt; MVCNNCorrel&lt;/FileModeleCost&gt;
                    &lt;FileModeleParams&gt;../MODEL_MSAFF_AERIAL_DECISION/.*.pt&lt;/FileModeleParams&gt;
                    &lt;FileModeleArch&gt;UnetMLPMatcher&lt;/FileModeleArch&gt;
                    &lt;Cuda&gt; ${OnCuda} &lt;/Cuda&gt;
		&lt;UsePredicNet&gt; ${UseMLP} &lt;/UsePredicNet&gt;
                &lt;/ScoreLearnedMMVII&gt;
            &lt;/TypeCAH&gt;
        &lt;/CorrelAdHoc&gt;
&lt;/EtapeMEC&gt;	
&lt;EtapeMEC&gt; 
    &lt;DeZoom&gt; 1  &lt;/DeZoom&gt; 
        &lt;CorrelAdHoc&gt;
            &lt;SzBlocAH&gt; 40000000 &lt;/SzBlocAH&gt;
            &lt;TypeCAH&gt;
                &lt;ScoreLearnedMMVII &gt;
                    &lt;FileModeleCost&gt; MVCNNCorrel&lt;/FileModeleCost&gt;
                    &lt;FileModeleParams&gt;../MODEL_MSAFF_AERIAL_DECISION/.*.pt&lt;/FileModeleParams&gt;
                    &lt;FileModeleArch&gt;UnetMLPMatcher&lt;/FileModeleArch&gt;
                    &lt;Cuda&gt; ${OnCuda} &lt;/Cuda&gt;
		&lt;UsePredicNet&gt; ${UseMLP} &lt;/UsePredicNet&gt;
                &lt;/ScoreLearnedMMVII&gt;
            &lt;/TypeCAH&gt;
        &lt;/CorrelAdHoc&gt;
    
&lt;/EtapeMEC&gt;
</pre></div>
</div>
   <!-- <EtapeMEC>
        <DeZoom > 1 </DeZoom>
        <Px1Pas>   0.5  </Px1Pas>
    </EtapeMEC> -->
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;EtapeMEC&gt;
        &lt;DeZoom&gt;  1  &lt;/DeZoom&gt;
        &lt;Px1Pas&gt;   1.0     &lt;/Px1Pas&gt;
        &lt;AlgoRegul&gt; eAlgoDequant &lt;/AlgoRegul&gt;
&lt;/EtapeMEC&gt; 
    
&lt;HighPrecPyrIm&gt; false &lt;/HighPrecPyrIm&gt;

&lt;TypePyramImage&gt;
           &lt;Resol &gt;    1          &lt;/Resol&gt;
           &lt;DivIm&gt;    1 &lt;/DivIm&gt;
           &lt;TypeEl&gt;  eFloat32Bits   &lt;/TypeEl&gt;
    &lt;/TypePyramImage&gt;
</pre></div>
</div>
<p>&lt;/Section_MEC&gt;</p>
<!--  *************************************************************
       Parametres fixant les resultats
     devant etre produits par l'algo
-->
<p>&lt;Section_Results&gt;
<GeomMNT> eGeomPxBiDim     </GeomMNT>
<ZoomMakeTA> 16 </ZoomMakeTA>
<GammaVisu> 2.0 </GammaVisu>
<ZoomVisuLiaison> -1 </ZoomVisuLiaison></p>
<p>&lt;/Section_Results&gt;</p>
<!--  *************************************************************
       Parametres lies a la gestions
     du "chantier" sur la machine
-->
<p>&lt;Section_WorkSpace&gt;</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;WorkDir&gt; ThisDir &lt;/WorkDir&gt; 
&lt;TmpMEC&gt; ${DirMEC}/ &lt;/TmpMEC&gt;
&lt;TmpResult&gt; ${DirMEC}/ &lt;/TmpResult&gt;
&lt;TmpPyr&gt; ${DirPyram} &lt;/TmpPyr&gt;
&lt;PurgeMECResultBefore&gt;  ${Purge} &lt;/PurgeMECResultBefore&gt;

&lt;ByProcess&gt;  ${NbProc} &lt;/ByProcess&gt;

&lt;AvalaibleMemory&gt; 2048 &lt;/AvalaibleMemory&gt;
&lt;SzDalleMin&gt; 540 &lt;/SzDalleMin&gt;
&lt;SzDalleMax&gt; 512 &lt;/SzDalleMax&gt;
&lt;SzRecouvrtDalles&gt; 20 &lt;/SzRecouvrtDalles&gt;
&lt;SzMinDecomposCalc&gt; 40 &lt;/SzMinDecomposCalc&gt;
&lt;ComprMasque&gt; eComprTiff_None &lt;/ComprMasque&gt;
</pre></div>
</div>
<p>&lt;/Section_WorkSpace&gt;</p>
<p>&lt;Section_Vrac&gt;
<DebugMM> true</DebugMM>
&lt;/Section_Vrac&gt;</p>
</ParamMICMAC>
`
* The aformentionned xml file activates our models from `Zoom 4`, i.e models are in charge of reconstruction for zooms: 4,2,1.
This is accomplished with and adhoc correlation that calls a set of .pt models (feature extraction + mlp).
`
            <CorrelAdHoc>
                <SzBlocAH> 40000000 </SzBlocAH>
                <TypeCAH>
                    <ScoreLearnedMMVII >
                        <FileModeleCost> MVCNNCorrel</FileModeleCost>
                        <FileModeleParams>../MODEL_MSAFF_AERIAL_DECISION/.*.pt</FileModeleParams>
                        <FileModeleArch>UnetMLPMatcher</FileModeleArch>
                        <Cuda> ${OnCuda} </Cuda>
			            <UsePredicNet> ${UseMLP} </UsePredicNet>
                    </ScoreLearnedMMVII>
                </TypeCAH>
            </CorrelAdHoc>
`
* Parametrization: To launch stereo matching between a pair of epipolar images,
<p><code class="docutils literal notranslate"><span class="pre">mm3d</span> <span class="pre">MICMAC</span> <span class="pre">File.xml</span> <span class="pre">+Im1=Im1.tif</span> <span class="pre">+Im2=Im2.tif</span>&#160; <span class="pre">+DirMEC=MEC/</span> <span class="pre">+OnCuda=0</span> <span class="pre">+UsePredicNet=1</span></code></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="prepare_dataset.html" class="btn btn-neutral float-left" title="Preparing data for training" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../guides/train_new_model.html" class="btn btn-neutral float-right" title="How to train new models" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>